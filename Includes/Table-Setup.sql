{"version":"NotebookV1","origId":17383838,"name":"Table-Setup","language":"sql","commands":[{"version":"CommandV1","origId":17383839,"guid":"893b0dd9-2d26-4658-a3a6-f27e79752bf8","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px; height: 163px\">\n</div>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"100006","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1dc8286a-5895-4cb9-84fd-ba77e5ceb602"},{"version":"CommandV1","origId":17383840,"guid":"6b943150-84ea-4ab7-912d-293c2c918428","subtype":"command","commandType":"auto","position":2.0,"command":"-- This assumes you've already uploaded the datasets to dbfs:/FileStore/tables","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"100006","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0f1f30ef-ea7c-4cad-bdf7-9a4c12f77525"},{"version":"CommandV1","origId":17383841,"guid":"9abce166-4e3b-49d4-b9d3-9794a2592677","subtype":"command","commandType":"auto","position":3.0,"command":"CREATE DATABASE IF NOT EXISTS synpuf_csv;\nUSE synpuf_csv;\n\nDROP TABLE IF EXISTS condition_occurrence;\nDROP TABLE IF EXISTS drug_exposure;\nDROP TABLE IF EXISTS person;\n\nCREATE TABLE condition_occurrence\nUSING csv\nOPTIONS (\n  header=true,\n  inferSchema=false,\n  nullValue='null',\n  timestampFormat=\"yyyy-MM-dd'T'hh:mm:ss.SSSZ\")\nLOCATION 'dbfs:/FileStore/tables/synpuf_condition_occurrence.csv';\n\nCREATE TABLE drug_exposure\nUSING csv\nOPTIONS (\n  header=true,\n  inferSchema=false,\n  nullValue='null',\n  timestampFormat=\"yyyy-MM-dd'T'hh:mm:ss.SSSZ\")\nLOCATION 'dbfs:/FileStore/tables/synpuf_drug_exposure.csv';\n\nCREATE TABLE person\nUSING csv\nOPTIONS (\n  header=true,\n  inferSchema=false,\n  nullValue='null',\n  timestampFormat=\"yyyy-MM-dd'T'hh:mm:ss.SSSZ\")\nLOCATION 'dbfs:/FileStore/tables/synpuf_person.csv';","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"100006","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bb6c8ae8-6459-4140-84d9-addede693d2f"},{"version":"CommandV1","origId":17383842,"guid":"5780ffea-be26-40d9-998a-e7b0dd8a953d","subtype":"command","commandType":"auto","position":4.0,"command":"CREATE DATABASE IF NOT EXISTS synpuf_extra;\nUSE synpuf_extra;\n\nDROP TABLE IF EXISTS condition_occurrence;\nDROP TABLE IF EXISTS drug_exposure;\nDROP TABLE IF EXISTS person;\n\nCREATE TABLE condition_occurrence\nUSING csv\nOPTIONS (\n  header=true,\n  inferSchema=true,\n  nullValue='null',\n  timestampFormat=\"yyyy-MM-dd'T'hh:mm:ss.SSSZ\")\nLOCATION 'dbfs:/FileStore/tables/synpuf_condition_occurrence.csv';\n\nCREATE TABLE drug_exposure\nUSING csv\nOPTIONS (\n  header=true,\n  inferSchema=true,\n  nullValue='null',\n  timestampFormat=\"yyyy-MM-dd'T'hh:mm:ss.SSSZ\")\nLOCATION 'dbfs:/FileStore/tables/synpuf_drug_exposure.csv';\n\nCREATE TABLE person\n(\n  `person_id` INT,\n  `gender_concept_id` INT,\n  `year_of_birth` INT,\n  `month_of_birth` INT,\n  `day_of_birth` INT,\n  `race_concept_id` INT,\n  `ethnicity_concept_id` INT,\n  `location_id` INT,\n  `provider_id` INT,\n  `care_site_id` INT,\n  `person_source_value` STRING,\n  `gender_source_value` INT,\n  `race_source_value` INT,\n  `ethnicity_source_value` INT)\nUSING csv\nOPTIONS (\n  header=true,\n  inferSchema=false,\n  nullValue='null',\n  timestampFormat=\"yyyy-MM-dd'T'hh:mm:ss.SSSZ\")\nLOCATION 'dbfs:/FileStore/tables/synpuf_person.csv';","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"100006","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"eeac8ab5-691c-414b-a9d5-3903767cb973"},{"version":"CommandV1","origId":17383843,"guid":"1a25cbc7-de72-4dc3-9112-e96e357cb2bf","subtype":"command","commandType":"auto","position":5.0,"command":"CREATE DATABASE IF NOT EXISTS synpuf_delta;\nUSE synpuf_delta;\n\nDROP TABLE IF EXISTS condition_occurrence;\nDROP TABLE IF EXISTS drug_exposure;\nDROP TABLE IF EXISTS person;\n\nCREATE TABLE condition_occurrence\nUSING DELTA AS\nSELECT * FROM synpuf_csv.condition_occurrence;\n\nCREATE TABLE drug_exposure\nUSING DELTA AS\nSELECT * FROM synpuf_csv.drug_exposure;\n\nCREATE TABLE person\nUSING DELTA AS\nSELECT * FROM synpuf_csv.person;\n\nOPTIMIZE condition_occurrence ZORDER BY condition_source_value;\nOPTIMIZE drug_exposure ZORDER BY drug_source_value;\nOPTIMIZE person;\n\nANALYZE TABLE condition_occurrence COMPUTE STATISTICS;\nANALYZE TABLE drug_exposure COMPUTE STATISTICS;\nANALYZE TABLE person COMPUTE STATISTICS;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"100006","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"097fff82-fa02-44fd-ae3f-b05d94488f97"},{"version":"CommandV1","origId":17383844,"guid":"74750b89-7308-40c5-9d50-fbe0d18bcad3","subtype":"command","commandType":"auto","position":6.0,"command":"CREATE DATABASE IF NOT EXISTS synpuf;\nUSE synpuf;\n\nDROP TABLE IF EXISTS condition_occurrence;\nDROP TABLE IF EXISTS drug_exposure;\nDROP TABLE IF EXISTS person;\n\nCREATE TABLE condition_occurrence\nUSING DELTA AS\nSELECT * FROM synpuf_csv.condition_occurrence;\n\nCREATE TABLE drug_exposure\nUSING DELTA AS\nSELECT * FROM synpuf_csv.drug_exposure;\n\nCREATE TABLE person\nUSING DELTA AS\nSELECT * FROM synpuf_csv.person;\n\nOPTIMIZE condition_occurrence ZORDER BY condition_source_value;\nOPTIMIZE drug_exposure ZORDER BY drug_source_value;\nOPTIMIZE person;\n\nANALYZE TABLE condition_occurrence COMPUTE STATISTICS;\nANALYZE TABLE drug_exposure COMPUTE STATISTICS;\nANALYZE TABLE person COMPUTE STATISTICS;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"100006","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1f444a73-3298-48be-b1db-9c17e45fcfb2"},{"version":"CommandV1","origId":17383845,"guid":"85f25c72-c85e-4004-aec0-32066314bff5","subtype":"command","commandType":"auto","position":7.0,"command":"USE DEFAULT;\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"100006","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8f7f4326-09a3-4fa9-9eeb-1539cbd8bc52"},{"version":"CommandV1","origId":17383846,"guid":"c2b4efd0-1b78-4448-9244-93e369ac35ea","subtype":"command","commandType":"auto","position":8.0,"command":"%md-sandbox\n&copy; 2019 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"http://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"http://help.databricks.com/\">Support</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"100006","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bd1bd6c8-9790-400c-b74e-b1cdb0bbaa6d"}],"dashboards":[],"guid":"66bc5e42-06f3-40ff-8ecd-9a1826070ee2","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}